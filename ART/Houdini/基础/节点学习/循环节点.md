# 循环节点

## 判断

For：对一个物体多次操作

For Each：对多个物体逐个进行一次操作

## 输入端Block Begin

循环方式：
Fetch FeedBack：每次计算循环基于上一次的结果 - For
Extract Piece or Point：每次循环计算基于每个元素 - For Each
Fetch Metadata：标记处循环次数等相关属性数值（辅助）
Fetch Input：每次循环计算基于原始 - For

## 输出端Block End

Iteration迭代方式：
Auto Detect from Inputs：根据输入自动选择
By Pieces or Points：根据点、线、面等元素决定循环次数 - For Each
By Count：定义循环次数 - For

Gather输出方式：
Feedback Each Iteration：每次循环单独输出结果
Merge Each Iteration：输出合并结果

## 变化

在循环体中增加一个Fetch Metadata的Begin节点，用于标记循环次数

其属性iteration：当前循环次数（从0开始计），numiterations：总循环次数（从1开始计）

---

例子：

**For**

把一个物体连续做Transform变换，通过常数控制循环次数。

```C++
for(int i = 0;i<10;i++)
    obj.y += 2;
```

![img](./imgs/XunHuan1.png)

![img](./imgs/XunHuan2.png)

**For Each**

把5个猪头合并后接入循环，结束循环节点的Pieces属性会自动分类

```c++
std::Vector<Geometry> objs = {pig1, pig2, pig3, pig4, pig5};
for(Geometry obj : objs)
    obj.y += 2;
-----------------------------Houdini Foreach----------------------------------
for(int i=0;i<6;i++){
    objs[i].y += 2;
}

```

![img](./imgs/XunHuan3.png)

![img](./imgs/XunHuan4.png)

**变化**

![img](./imgs/XunHuan5.png)

![img](./imgs/XunHuan6.png)